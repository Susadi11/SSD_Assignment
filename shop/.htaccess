# Enable mod_headers module
<IfModule mod_headers.c>
  # Apply CSP to ALL files including robots.txt and sitemap.xml
  Header always set Content-Security-Policy "default-src 'self'; \
    script-src 'self' 'unsafe-inline' 'unsafe-eval' https://accounts.google.com https://apis.google.com; \
    style-src  'self' 'unsafe-inline' https://fonts.googleapis.com; \
    img-src    'self' data: blob: https: http:; \
    font-src   'self' https://fonts.gstatic.com https://fonts.googleapis.com; \
    frame-src  'self' https://accounts.google.com; \
    connect-src 'self'; \
    form-action 'self' https://accounts.google.com; \
    object-src 'none'; \
    media-src  'self'; \
    worker-src 'self'; \
    child-src  'self'; \
    base-uri 'self'; \
    upgrade-insecure-requests"
  Header always set X-Content-Type-Options "nosniff"
  Header always set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>

# Specific rules for robots.txt
<Files "robots.txt">
  <IfModule mod_headers.c>
    Header always set Content-Security-Policy "default-src 'none'"
  </IfModule>
</Files>

# Specific rules for sitemap.xml
<Files "sitemap.xml">
  <IfModule mod_headers.c>
    Header always set Content-Security-Policy "default-src 'none'"
  </IfModule>
</Files>

# Apply to all XML files
<FilesMatch "\.(xml)$">
  <IfModule mod_headers.c>
    Header always set Content-Security-Policy "default-src 'none'"
  </IfModule>
</FilesMatch>

# Apply to all TXT files
<FilesMatch "\.(txt)$">
  <IfModule mod_headers.c>
    Header always set Content-Security-Policy "default-src 'none'"
  </IfModule>
</FilesMatch>

# Enable rewrite engine for clean URLs (if needed)
RewriteEngine On